(this["webpackJsonpteeworlds-master-cache-frontend"]=this["webpackJsonpteeworlds-master-cache-frontend"]||[]).push([[0],{112:function(e,t,r){e.exports=r(368)},368:function(e,t,r){"use strict";r.r(t);var n=r(2),a=r.n(n),s=r(8),i=r.n(s),o=r(55),l=r(56),c=r(43),u=r(58),p=r(57),d=r(9),f=(r(111),function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props,t=e.serverFilter,r=e.serverFilterHandleChange,n=e.onClickAdd;return a.a.createElement("div",null,a.a.createElement(d.Layout.Row,null,a.a.createElement(d.Layout.Col,{span:"6"},a.a.createElement(d.Input,{placeholder:"\u7b5b\u9009\u6216\u6dfb\u52a0\u670d\u52a1\u5668",value:t,onChange:r})),a.a.createElement(d.Layout.Col,{span:"6"},a.a.createElement(d.Button,{type:"primary",onClick:n},"\u6dfb\u52a0"))))}}]),r}(a.a.Component));r(367);function h(e,t,r){var n=+e;return n>=t&&n<=r&&e===n.toString()}var v=function(e){Object(u.a)(r,e);var t=Object(p.a)(r);function r(e){var n;Object(o.a)(this,r),(n=t.call(this,e)).api_url="https://master.tw.actom.me/api/v1/server_list";var s=JSON.parse(localStorage.getItem("state"))?JSON.parse(localStorage.getItem("state")):{token:"",filter:""};n.state={token:s.token,filter:s.filter,page:1,error:null,isLoaded:!1,servers:[],filteredservers:[]},n.tokenHandleChange=function(e){n.setState({token:e})},n.serverFilterHandleChange=function(e){var t=n.state.servers.filter((function(t){return(t.ip+":"+t.port).includes(e)}));n.setState({page:1,filter:e,filteredservers:t})},n.changePage=function(e){n.setState({page:e})},n.onClickAdd.bind(Object(c.a)(n)),n.onClickDelete.bind(Object(c.a)(n));var i=n.setState;return n.setState=function(){var e=arguments,t=this,r=arguments[0],n=function(){return e[1],localStorage.setItem("state",JSON.stringify(t.state))};i.bind(this)(r,n)},n.columns=[{label:"\u670d\u52a1\u5668\u5730\u5740",width:250,fixed:"left",prop:"serverStringData",align:"center"},{label:"\u64cd\u4f5c",width:120,align:"center",render:function(e,t,r){return a.a.createElement("span",null,a.a.createElement(d.Button,{type:"primary",onClick:function(e){return n.onClickDelete(n.state.filteredservers[r],e)}},"\u79fb\u9664"))}}],n}return Object(l.a)(r,[{key:"onClickAdd",value:function(e){var t=this;if(function(e){var t=e.split(":"),r=t[0].split(".");return h(t[1],1,65535)&&4===r.length&&r.every((function(e){return h(e,0,255)}))}(e)){var r={ip:e.split(":")[0],port:parseInt(e.split(":")[1])},n=!1;if(this.state.servers.forEach((function(e){e.ip===r.ip&&e.port===r.port&&(n=!0)})),n)d.Message.warning("\u6b64\u670d\u52a1\u5668\u5df2\u7ecf\u5728\u5217\u8868\u4e2d");else{var a={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:this.state.token,data:r})};fetch(this.api_url,a).then((function(e){return e.json()})).then((function(e){if(0===e.Code){d.Message.success("\u6dfb\u52a0\u6210\u529f"),t.state.servers.push(r);var n=t.state.servers.filter((function(e){return(e.ip+":"+e.port).includes(t.state.filter)}));t.setState({servers:t.state.servers,filteredservers:n})}else d.Message.error("\u8fd4\u56de\u9519\u8bef\uff1a"+e.Message)}),(function(e){d.Message.error("\u8bf7\u6c42\u5931\u8d25\uff1a"+e)}))}}else d.Message.error("\u670d\u52a1\u5668\u5730\u5740\u683c\u5f0f\u9519\u8bef")}},{key:"onClickDelete",value:function(e){var t=this,r={method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:this.state.token,data:{ip:e.ip,port:parseInt(e.port)}})};fetch(this.api_url,r).then((function(e){return e.json()})).then((function(r){if(0===r.Code){d.Message.success("\u5220\u9664\u6210\u529f");var n=t.state.servers.filter((function(t){return e!==t})),a=n.filter((function(e){return(e.ip+":"+e.port).includes(t.state.filter)}));t.setState({servers:n,filteredservers:a})}else d.Message.error("\u8fd4\u56de\u9519\u8bef\uff1a"+r.Message)}),(function(e){d.Message.error("\u8bf7\u6c42\u5931\u8d25\uff1a"+e)}))}},{key:"componentDidMount",value:function(){var e=this;fetch(this.api_url).then((function(e){return e.json()})).then((function(t){var r=t.Data.map((function(e){return{ip:e.ip,port:e.port}})),n=r.filter((function(t){return(t.ip+":"+t.port).includes(e.state.filter)}));e.setState({isLoaded:!0,servers:r,filteredservers:n}),d.Message.success("\u5171\u83b7\u53d6"+r.length+"\u6761\u670d\u52a1\u5668\u4fe1\u606f")}),(function(t){e.setState({isLoaded:!0,error:t})}))}},{key:"render",value:function(){var e=this,t=this.state,r=t.token,n=t.filter,s=t.error,i=t.isLoaded,o=t.filteredservers;return s?a.a.createElement(d.Loading,{text:"\u52a0\u8f7d\u9519\u8bef\uff0c\u8bf7\u5237\u65b0",fullscreen:!0}):a.a.createElement("div",null,!i&&a.a.createElement(d.Loading,{text:"\u62fc\u547d\u52a0\u8f7d\u4e2d",fullscreen:!0}),a.a.createElement("div",null,a.a.createElement(d.Menu,{theme:"dark",defaultActive:"1",className:"el-menu-demo",mode:"horizontal"},a.a.createElement(d.Menu.Item,{index:"1"},"TeeMaster \u63a7\u5236\u4e2d\u5fc3"))),a.a.createElement(d.Input,{placeholder:"\u589e\u51cf\u8bb0\u5f55\u9700\u8981\u8f93\u5165token",value:r,onChange:this.tokenHandleChange}),a.a.createElement(f,{serverFilter:n,serverFilterHandleChange:this.serverFilterHandleChange,onClickAdd:function(t){return e.onClickAdd(n,t)}}),a.a.createElement(d.Table,{columns:this.columns,data:o.slice(50*(this.state.page-1),50*this.state.page).map((function(e){return{serverStringData:e.ip+":"+e.port}})),border:!0}),a.a.createElement("div",{className:"block"},a.a.createElement(d.Pagination,{layout:"total, prev, pager, next, jumper",onCurrentChange:this.changePage,total:this.state.filteredservers.length,pageSize:50,currentPage:1})))}}]),r}(a.a.Component);i.a.render(a.a.createElement(v,null),document.getElementById("root"))}},[[112,1,2]]]);
//# sourceMappingURL=main.388dabfe.chunk.js.map